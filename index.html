<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Wetterstation</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>Wetterstation</h1>

<div>
  <p>Temperatur: <span id="temp"></span> Â°C</p>
  <p>Luftfeuchte: <span id="hum"></span> %</p>
  <p>Luftdruck: <span id="pres"></span> hPa</p>
</div>

<canvas id="chart" width="400" height="200"></canvas>

<script>
  // Firebase config
  const firebaseConfig = {
    databaseURL: "https://meine-wetterstation-default-rtdb.europe-west1.firebasedatabase.app"
  };
  firebase.initializeApp(firebaseConfig);

  const db = firebase.database();

  // Live-Daten
  db.ref("weather").on("value", snap => {
    const d = snap.val();
    document.getElementById("temp").innerText = d.temperature.toFixed(1);
    document.getElementById("hum").innerText  = d.humidity.toFixed(1);
    document.getElementById("pres").innerText = d.pressure.toFixed(1);
  });

  // History-Daten
  db.ref("history/2026/02/07").once("value", snap => {
    const data = snap.val();
    const labels = [];
    const temps = [];

    for (let key in data) {
      labels.push(key);
      temps.push(data[key].temperature);
    }

    new Chart(document.getElementById("chart"), {
      type: "line",
      data: {
        labels: labels,
        datasets: [{
          label: "Temperatur",
          data: temps,
          borderColor: "red"
        }]
      }
    });
  });
</script>

</body>
</html>
